{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 1f0798fb89c2052c3198","webpack:///./src/core.js","webpack:///./src/sp-listitems.js","webpack:///./src/utils/utils.js","webpack:///./src/utils/conversion.js","webpack:///./src/utils/sphelper.js","webpack:///./src/utils/request.js","webpack:///./src/utils/objects.js","webpack:///./src/utils/storage.js","webpack:///./src/utils/strings.js","webpack:///./src/utils/templates.js","webpack:///./src/utils/url.js","webpack:///./src/sp-delve.js","webpack:///./src/sp-files.js","webpack:///./src/sp-lists.js","webpack:///./src/sp-search.js","webpack:///./src/sp-users.js"],"names":["SPOC","_name","SP","Site","url","window","_spPageContextInfo","webAbsoluteUrl","ListItems","Delve","Files","Lists","Search","User","username","id","userId","loginName","userLoginName","Profile","listTitle","site","methods","query","settings","cache","headers","listUrl","Conversion","objToQueryString","Request","get","queryCSOM","camlQuery","Promise","resolve","reject","ctx","ClientContext","list","get_web","get_lists","getByTitle","CamlQuery","set_viewXml","createAllItemsQuery","items","getItems","load","executeQueryAsync","result","get_data","map","i","get_fieldValues","err","create","data","library","defaults","__metadata","getListItemType","Objects","merge","post","update","SPHelper","put","delete","Utils","Storage","Strings","Tpl","Url","obj","str","propertyName","string","replace","name","meta","toUpperCase","substring","location","href","toLowerCase","indexOf","ext","getFileExtension","PrimaryQueryResult","RelevantResults","Table","Rows","finalarray","item","a","results","length","Cells","Key","Value","push","cacheResult","isSameDomain","convertToXDomain","appweburl","AppWebUrl","hostweburl","HostWebUrl","loadRequestor","then","executor","RequestExecutor","executeAsync","method","success","error","req","XMLHttpRequest","open","setRequestHeader","onreadystatechange","readyState","status","JSON","parse","responseText","d","set","Error","statusText","onerror","send","isFile","document","getElementById","value","byteLength","body","stringify","script","createElement","src","addEventListener","appendChild","prop","obj1","obj2","p","constructor","Object","e","key","useLocalStorage","storageAvailable","storageObj","localStorage","sessionStorage","getItem","setItem","removeItem","ca","cookie","split","c","trim","days","expires","date","Date","setTime","getTime","toGMTString","setCookies","requiredLength","substr","pop","parts","property","tpl","regex","matches","match","len","RegExp","getProperty","variable","search","vars","pair","unescape","exec","decodeURIComponent","getQueryString","origin","protocol","hostname","port","domain","userEmail","board","searchTerm","actions","searchUrl","actor","formatSearchResponse","DocId","filePath","generateExternalLink","hours","uploadViaModal","GUID","dialogOptions","dialogReturnValueCallback","Function","createDelegate","UI","ModalDialog","showModalDialog","upload","fileInput","expand","reader","FileReader","onloadend","fileName","target","readAsArrayBuffer","files","uploadFile","file","download","openInWebApps","newTab","convertToWebApp","BaseTemplate","Description","user","loginNamePrefix","isMemberOfGroup","groupName"],"mappings":"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","file":"SPOCExt.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"SPOCExt\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"SPOCExt\"] = factory();\n\telse\n\t\troot[\"SPOCExt\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 1f0798fb89c2052c3198\n **/","import ListItems from './sp-listitems';\nimport Delve from './sp-delve';\nimport Files from './sp-files';\nimport Lists from './sp-lists';\nimport Search from './sp-search';\nimport Profile from './sp-users';\n\nclass SPOC {\n\tconstructor() {\n\t\tthis._name = 'SPOC';\n\t}\n\n\tget name() {\n\t\treturn this._name;\n\t}\n};\n\nSPOC.SP = class {\n\tconstructor() {\n\t\tthis._name = 'SP';\n\t}\n\n\tget name() {\n\t\treturn this._name;\n\t}\n};\n\nSPOC.SP.Site = class {\n\tconstructor(url) {\n\t\tthis.url = url ? url : window._spPageContextInfo.webAbsoluteUrl;\n\n\t\tthis.ListItems = ListItems;\n\t\tthis.Delve = Delve;\n\t\tthis.Files = Files;\n\t\tthis.Lists = Lists;\n\t\tthis.Search = Search;\n\t}\n};\n\nSPOC.SP.User = class {\n\tconstructor(username) {\n\t\tthis.id = username ? username : window._spPageContextInfo.userId;\n\t\tthis.loginName = username ? username : window._spPageContextInfo.userLoginName;\n\n\t\tthis.Profile = Profile;\n\t}\n};\n\nexport default SPOC;\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/core.js\n **/","import Utils from './utils/utils';\n\nfunction ListItems(listTitle) {\n    var site = this,\n        methods = {};\n\n    methods.query = function(settings, cache, headers) {\n        var listUrl = site.url + '/_api/web/lists/getByTitle%28%27' + listTitle + '%27%29/items';\n\n        listUrl += settings ? '?' + Utils.Conversion.objToQueryString(settings) : '';\n\n        return Utils.Request.get(listUrl, cache);\n    };\n\n    methods.queryCSOM = function(camlQuery) {\n        return new Promise(function(resolve, reject) {\n            var ctx = new SP.ClientContext(site.url),\n                list = ctx.get_web().get_lists().getByTitle(listTitle),\n                query;\n\n            if (camlQuery) {\n                query = new SP.CamlQuery();\n                query.set_viewXml(camlQuery);\n            } \n            else {\n                query = SP.CamlQuery.createAllItemsQuery();\n            }\n\n            var items = list.getItems(query);\n\n            ctx.load(items);\n\n            ctx.executeQueryAsync(function() {\n                var result = items.get_data().map(function(i) {\n                    return i.get_fieldValues();   \n                });\n\n                resolve(result);\n\n            }, function(err) {\n                reject(err);\n            });\n        });\n    };\n\n    methods.create = function(data, library) {\n        var listUrl = site.url + '/_api/web/lists/getByTitle%28%27' + listTitle + '%27%29/items',\n            defaults = {\n                __metadata: {\n                    'type': SP.getListItemType(listTitle, library)\n                }\n            };\n\n        if (data) {\n            defaults = Utils.Objects.merge(defaults, data);\n        }\n\n        return Utils.Request.post(listUrl, defaults);\n    };\n\n    methods.update = function(id, data, library) {\n        var listUrl = site.url + '/_api/web/lists/getByTitle%28%27' + listTitle + '%27%29/items(' + id + ')',\n            defaults = {\n                __metadata: {\n                    'type': Utils.SPHelper.getListItemType(listTitle, library)\n                }\n            };\n\n        if (data) {\n            defaults = Utils.Objects.merge(defaults, data);\n        }\n\n        return Utils.Request.put(listUrl, defaults);\n    };\n\n    methods.delete = function(id, library) {\n        var listUrl = site.url + '/_api/web/lists/getByTitle%28%27' + listTitle + '%27%29/items(' + id + ')',\n            defaults = {\n                __metadata: {\n                    'type': Utils.SPHelper.getListItemType(listTitle, library)\n                }\n            };\n\n        return Utils.Request.delete(listUrl, defaults);\n    };\n\n    return methods;\n};\n\nexport default ListItems;\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/sp-listitems.js\n **/","import Conversion from './conversion';\nimport SPHelper from './sphelper';\nimport Request from './request';\nimport Objects from './objects';\nimport Storage from './storage';\nimport Strings from './strings';\nimport Tpl from './templates';\nimport Url from './url';\n\nclass Utils {\n\tconstructor() {\n\t\tthis._name = 'Utils';\n\t}\n\n\tget name() {\n\t\treturn this._name;\n\t}\n};\n\nUtils.Conversion = Conversion;\nUtils.Request = Request;\nUtils.SPHelper = SPHelper;\nUtils.Objects = Objects;\nUtils.Storage = Storage;\nUtils.Strings = Strings;\nUtils.Tpl = Tpl;\nUtils.Url = Url;\n\nexport default Utils;\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/utils/utils.js\n **/","class Conversion {\n\tstatic objToQueryString(obj) {\n\t\tvar str = '';\n\n\t\tfor (var propertyName in obj) {\n\t\t\tstr += '&$' + propertyName + '=' + obj[propertyName];\n\t\t}\n\n\t\treturn str;\n\t}\n\n\tstatic spInternalName(string) {\n\t\treturn string.replace(/ /g, '_x0020_');\n\t}\n};\n\nexport default Conversion;\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/utils/conversion.js\n **/","import Utils from './utils';\n\nclass SPHelper {\n    static getListItemType(name, library) {\n        var meta = library ? \"Item\" : \"ListItem\";\n\n    \tname = name[0].toUpperCase() + name.substring(1);\n\n        return \"SP.Data.\" + name.replace(/ /g, '_x0020_') + meta;\n    };\n\n    static isAppWeb() {\n        return window.location.href.toLowerCase().indexOf('sphosturl') > -1;\n    };\n\n    static convertToWebApp(url) {\n        if (url.toLowerCase().indexOf('WopiFrame.aspx') > -1) {\n            return url;\n        } \n\n        var ext = Utils.Strings.getFileExtension(url);\n\n        if (ext === 'docx' || ext === 'pptx' || ext === 'xlsx') {\n            return window._spPageContextInfo.webAbsoluteUrl + '/_layouts/15/WopiFrame.aspx?sourcedoc=' + url;\n        } \n\n        return url;\n    };\n\n    static formatSearchResponse(data) {\n        var result = data.query.PrimaryQueryResult.RelevantResults.Table.Rows,\n            finalarray = [], item, obj, i, a;\n\n            result = result.results || [result];\n\n        for (i = 0; i < result.length; i++) { \n            item = result[i].Cells.results;\n            obj = {};\n\n            for (a = 0; a < item.length; a++) { \n                obj[item[a].Key] = item[a].Value;\n            }\n\n            finalarray.push(obj);\n        }\n\n        return finalarray;\n    };\n};\n\nexport default SPHelper;\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/utils/sphelper.js\n **/","import Utils from './utils';\n\nclass Request {\n    static get(url, cacheResult) {\n        return new Promise(function(resolve, reject) {\n            var cache = Utils.Storage.get('SPOC-' + url);\n\n            if (cache && cacheResult) {\n                resolve(cache);\n            } \n            else {\n                if (!Utils.Url.isSameDomain(url) && url.toLowerCase().indexOf('_api/web') > -1) {\n                    url = Utils.Url.convertToXDomain(url);\n\n                    var appweburl = Utils.Url.AppWebUrl(),\n                        hostweburl = Utils.Url.HostWebUrl();\n\n                    this.Request.loadRequestor(hostweburl + '/_layouts/15/SP.RequestExecutor.js').then(function() {\n                        var executor = new SP.RequestExecutor(appweburl);\n\n                        executor.executeAsync({\n                            url: url,\n                            method: \"GET\",\n                            headers: {\n                                \"Accept\": \"application/json; odata=verbose\"\n                            },\n                            success: function(data) {\n                                resolve(data);\n                            },\n                            error: function(err) {\n                                reject(err);\n                            }\n                        });\n                    });\n                } \n                else {\n                    var req = new XMLHttpRequest();\n\n                    req.open('GET', url, true);\n                    req.setRequestHeader(\"Accept\", \"application/json;odata=verbose\");\n\n                    req.onreadystatechange = function() {\n                        if (req.readyState === 4) {\n                            if (req.status === 200) {\n                                var data = JSON.parse(req.responseText);\n\n                                data = data.d.results ? data.d.results : data.d;\n\n                                Utils.Storage.set('SPOC-' + url, data);\n\n                                resolve(data);\n                            } \n                            else {\n                                reject(Error(JSON.parse(req.statusText)));\n                            }\n                        }\n                    };\n\n                    req.onerror = function(err) {\n                        reject(Error('Network Error'));\n                    };\n\n                    req.send();\n                }\n            }\n        });\n    };\n\n    static post(url, data, isFile) {\n        return new Promise(function(resolve, reject) {\n            if (!Utils.Url.isSameDomain(url) && url.toLowerCase().indexOf('_api/web') > -1) {\n                url = Utils.Url.convertToXDomain(url);\n\n                var appweburl = Utils.Url.AppWebUrl(),\n                    hostweburl = Utils.Url.HostWebUrl();\n\n                this.Request.loadRequestor(hostweburl + '/_layouts/15/SP.RequestExecutor.js').then(function() {\n                    var executor = new SP.RequestExecutor(appweburl),\n                        headers = {\n                            \"Accept\": \"application/json; odata=verbose\",\n                            \"X-RequestDigest\": document.getElementById('__REQUESTDIGEST').value,\n                            \"Content-Type\": \"application/json;odata=verbose\"\n                        };\n\n                    if (isFile) {\n                        headers[\"Content-Type\"] = data.byteLength;\n                    }\n\n                    executor.executeAsync({\n                        url: url,\n                        method: \"POST\",\n                        body: JSON.stringify(data),\n                        headers: headers,\n                        success: function(data) {\n                            resolve(data);\n                        },\n                        error: function(err) {\n                            reject(err);\n                        }\n                    });\n                });\n            } \n            else {\n                var req = new XMLHttpRequest();\n\n                req.open('POST', url, true);\n                req.setRequestHeader(\"Accept\", \"application/json;odata=verbose\");\n                req.setRequestHeader(\"X-RequestDigest\", document.getElementById('__REQUESTDIGEST').value);\n                req.setRequestHeader(\"Content-Type\", \"application/json;odata=verbose\");\n\n                if (isFile) {\n                    req.setRequestHeader(\"content-length\", data.byteLength);\n                }\n\n                req.onreadystatechange = function() {\n                    if (req.readyState === 4) {\n                        if (req.status === 200 || req.status === 201 || req.status === 1223) {\n                            resolve(data);\n                        } \n                        else {\n                            reject(Error(req.statusText));\n                        }\n                    }\n                };\n\n                req.onerror = function(err) {\n                    reject(Error('Network Error'));\n                };\n\n                req.send(isFile ? data : JSON.stringify(data));\n            }\n            \n        });\n    };\n\n    static put(url, data) {\n        return new Promise(function(resolve, reject) {\n            if (!Utils.Url.isSameDomain(url) && url.toLowerCase().indexOf('_api/web') > -1) {\n                url = Utils.Url.convertToXDomain(url);\n\n                var appweburl = Utils.Url.AppWebUrl(),\n                    hostweburl = Utils.Url.HostWebUrl();\n\n                this.Request.loadRequestor(hostweburl + '/_layouts/15/SP.RequestExecutor.js').then(function() {\n                    var executor = new SP.RequestExecutor(appweburl),\n                        headers = {\n                            \"Accept\": \"application/json; odata=verbose\",\n                            \"X-RequestDigest\": document.getElementById('__REQUESTDIGEST').value,\n                            \"Content-Type\": \"application/json;odata=verbose\",\n                            \"X-HTTP-Method\": \"MERGE\",\n                            \"If-Match\": \"*\"\n                        };\n\n                    executor.executeAsync({\n                        url: url,\n                        method: \"POST\",\n                        body: JSON.stringify(data),\n                        headers: headers,\n                        success: function(data) {\n                            resolve(data);\n                        },\n                        error: function(err) {\n                            reject(err);\n                        }\n                    });\n                });\n            } \n            else {\n                var req = new XMLHttpRequest();\n\n                req.open('POST', url, true);\n                req.setRequestHeader(\"Accept\", \"application/json;odata=verbose\");\n                req.setRequestHeader(\"X-RequestDigest\", document.getElementById('__REQUESTDIGEST').value);\n                req.setRequestHeader(\"Content-Type\", \"application/json;odata=verbose\");\n                req.setRequestHeader(\"X-HTTP-Method\", \"MERGE\");\n                req.setRequestHeader(\"If-Match\", \"*\");\n\n                req.onreadystatechange = function() {\n                    if (req.readyState === 4) {\n                        if (req.status === 200 || req.status === 204 || req.status === 1223) {\n                            resolve(data);\n                        } \n                        else {\n                            reject(Error(req.statusText));\n                        }\n                    }\n                };\n\n                req.onerror = function(err) {\n                    reject(Error('Network Error'));\n                };\n\n                req.send(JSON.stringify(data));\n            }\n        });\n    };\n\n    static delete(url, data) {\n        return new Promise(function(resolve, reject) {\n            if (!Utils.Url.isSameDomain(url) && url.toLowerCase().indexOf('_api/web') > -1) {\n                url = Utils.Url.convertToXDomain(url);\n\n                var appweburl = Utils.Url.AppWebUrl(),\n                    hostweburl = Utils.Url.HostWebUrl();\n\n                this.Request.loadRequestor(hostweburl + '/_layouts/15/SP.RequestExecutor.js').then(function() {\n                    var executor = new SP.RequestExecutor(appweburl), \n                        headers = {\n                            \"Accept\": \"application/json; odata=verbose\",\n                            \"X-RequestDigest\": document.getElementById('__REQUESTDIGEST').value,\n                            \"Content-Type\": \"application/json;odata=verbose\",\n                            \"X-HTTP-Method\": \"DELETE\",\n                            \"If-Match\": \"*\"\n                        };\n\n                    executor.executeAsync({\n                        url: url,\n                        method: \"POST\",\n                        body: JSON.stringify(data),\n                        headers: headers,\n                        success: function(data) {\n                            resolve(data);\n                        },\n                        error: function(err) {\n                            reject(err);\n                        }\n                    });\n                });\n            } \n            else {\n                var req = new XMLHttpRequest();\n\n                req.open('POST', url, true);\n                req.setRequestHeader(\"X-RequestDigest\", document.getElementById('__REQUESTDIGEST').value);\n                req.setRequestHeader(\"X-HTTP-Method\", \"DELETE\");\n                req.setRequestHeader(\"If-Match\", \"*\");\n\n                req.onreadystatechange = function() {\n                    if (req.readyState === 4) {\n                        if (req.status === 200 || req.status === 204 || req.status === 1223) {\n                            resolve(data);\n                        } \n                        else {\n                            reject(Error(req.statusText));\n                        }\n                    }\n                };\n\n                req.onerror = function(err) {\n                    reject(Error('Network Error'));\n                };\n\n                req.send(JSON.stringify(data));\n            }\n        });\n    };\n\n    static loadRequestor(url) {\n        return new Promise(function(resolve, reject) {\n            var script = document.createElement('script');\n\n            script.src = url;\n\n            script.addEventListener('load', function() {\n                resolve(url);\n            }, false);\n\n            script.addEventListener('error', function() {\n                reject(url);\n            }, false);\n\n            if (!SP.RequestExecutor) {\n                document.body.appendChild(script);\n            } \n            else {\n                resolve(url);\n            }\n        });\n    };\n};\n\nexport default Request;\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/utils/request.js\n **/","class Objects {\n    static findObjectByProperty(data, prop, value) {\n        for (var i = 0; i < data.length; i++) {\n            if (data[i][prop] === value) {\n                return data[i];\n            }\n        }\n\n        return false;\n    };\n\n    static merge(obj1, obj2) {\n        for (var p in obj2) {\n            try {\n                if (obj2[p].constructor === Object) {\n                    obj1[p] = this.merge(obj1[p], obj2[p]);\n                } \n                else {\n                    obj1[p] = obj2[p];\n                }\n            }\n            catch (e) {\n                obj1[p] = obj2[p];\n            }\n        }\n\n        return obj1;\n    };\n};\n\nexport default Objects;\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/utils/objects.js\n **/","class Storage {\n    static get(key, useLocalStorage) {\n        if (this.storageAvailable()) {\n            var storageObj = useLocalStorage ? localStorage : sessionStorage;\n\n            return JSON.parse(storageObj.getItem(key));\n        }\n        return null;\n    };\n\n    static storageAvailable() {\n        return (typeof(Storage) !== 'undefined');\n    };\n\n    static set(key, data, useLocalStorage) {\n        if (this.storageAvailable()) {\n            var storageObj = useLocalStorage ? localStorage : sessionStorage;\n\n            storageObj.setItem(key, (data === Object(data)) ? JSON.stringify(data) : data);\n        }\n    };\n\n    static get(key, useLocalStorage) {\n        if (this.storageAvailable()) {\n            var storageObj = useLocalStorage ? localStorage : sessionStorage;\n\n            return JSON.parse(storageObj.getItem(key));\n        }\n        return null;\n    };\n\n    static remove(key, useLocalStorage) {\n        if (this.storageAvailable()) {\n            var storageObj = useLocalStorage ? localStorage : sessionStorage;\n\n            storageObj.removeItem(key);\n        }\n    };\n\n    static getCookie(name) {\n        name = name + '=';\n\n        var ca = document.cookie.split(';');\n\n        for (var i = 0; i < ca.length; i++) {\n            var c = ca[i].trim();\n\n            if (c.indexOf(name) === 0) {\n                return c.substring(name.length, c.length);\n            }\n        }\n\n        return false;\n    };\n\n    static setCookies(name, value, days) {\n        var expires;\n\n        if (days) {\n            var date = new Date();\n\n            date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));\n            expires = '; expires=' + date.toGMTString();\n        }\n        else {\n            expires = '';\n        }\n\n        document.cookie = name + '=' + value + '; ' + expires;\n    };\n\n    static removeCookies(name) {\n        this.setCookies(name, '', -1);\n    };\n};\n\nexport default Storage;\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/utils/storage.js\n **/","class Strings {\n\tstatic cut(value, requiredLength) {\n\t\treturn value.length > requiredLength ? value.substr(0, requiredLength - 3) + \"...\" : value;\n\t};\n\n\tstatic getFileExtension(value) {\n\t\treturn value.split('.').pop();\n\t};\n};\n\nexport default Strings;\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/utils/strings.js\n **/","class Tpl {\n    static getProperty(propertyName, obj) {\n        var parts = propertyName.split(\".\"),\n            length = parts.length,\n            i, property = obj || this;\n\n        for (i = 0; i < length; i++) {\n            property = property[parts[i]];\n        }\n\n        return property;\n    };\n\n    static render(tpl, data) {\n        var regex = /{{(.*?)}}/g,\n            matches = tpl.match(regex);\n\n        if (matches && matches.length) {\n            for (var i = 0, len = matches.length; i < len; i++) {\n                tpl = tpl.replace(new RegExp(matches[i], 'g'), \n                            this.getProperty(matches[i].replace(/{{|}}/g, \"\"), data));\n            }\n        }\n\n        return tpl;\n    };\n};\n\nexport default Tpl;\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/utils/templates.js\n **/","class Url {\n    static getQueryString(variable, query) {\n        query = query ? query = query.split('?')[1] : window.location.search.substring(1);\n\n        var vars = query.split(\"&\");\n\n        for (var i = 0; i < vars.length; i++) {\n            var pair = vars[i].split(\"=\");\n\n            if (pair[0] === variable) {\n                return unescape(pair[1]);\n            }\n        }\n    };\n\n    static getListNameFromUrl(url) {\n        var regex = /\\%27(.*)\\%27/g,\n            match = regex.exec(url);\n\n        return match ? match[1] : null;\n    };\n\n    static AppWebUrl(url) {\n        return decodeURIComponent(this.getQueryString('SPAppWebUrl'));\n    };\n\n    static HostWebUrl(url) {\n        return decodeURIComponent(this.getQueryString('SPHostUrl'));\n    };\n\n    static isSameDomain(url) {\n        if (!window.location.origin) {\n            window.location.origin = window.location.protocol + \"//\" + window.location.hostname + \n                (window.location.port ? ':' + window.location.port : '');\n        }\n\n        return url.toLowerCase().indexOf(window.location.origin.toLowerCase()) > -1;\n    };\n\n    static convertToXDomain(url) {\n        url = url.toLowerCase().replace('/_api/', '/_api/SP.AppContextSite(@target)/');\n\n        var domain = url.split('/_api')[0],\n            origin = window.location.href.toLowerCase().split('/pages')[0];\n\n        url = url.split('/_api')[1];\n\n        if (url.indexOf('?') === -1) {\n            url = url + '?';\n        } else {\n            url = url + '&';\n        }\n\n        return origin + '/_api' + url + '@target=%27' + domain + '%27';\n    };\n};\n\nexport default Url;\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/utils/url.js\n **/","import { Utils } from './utils/utils';\n\nfunction Delve(userEmail) {\n    var site = this,\n        methods = {};\n\n    methods.board = function(searchTerm, actions, cache) {\n        return new Promise(function(resolve, reject) {\n            var searchUrl, actor;\n\n            if (!searchTerm) {\n                searchTerm = '*';\n            }\n\n            if (userEmail) {\n                searchUrl = site.url + \"/_api/search/query?Querytext=%27WorkEmail:\" + \n                                userEmail + \"%27&SelectProperties=%27UserName,DocId%27\";\n\n                Utils.Request.get(searchUrl, cache).then(function(result) {\n                    result = Utils.SPHelper.formatSearchResponse(result);\n\n                    if (result.length) {\n                        if (result.length > 1) {\n                            result = result[0];\n                        }\n\n                        actor = result.DocId;\n                        searchUrl = site.url + \"/_api/search/query?Querytext='\" + \n                                        searchTerm + \"'&amp;Properties='GraphQuery:ACTOR(\" + \n                                            actor + actions ? (\", \" + actions) : \"\" + \")\";\n\n                        Utils.Request.get(searchUrl, cache).then(function(board) {\n                            board = Utils.SPHelper.formatSearchResponse(board);\n                            resolve(board);\n                        }, function(err) {\n                             reject(err);\n                        });\n                    } \n                    else {\n                        resolve(null);\n                    }\n\n                }, function (err) {\n                    reject(err);\n                });\n            } \n            else {\n                searchUrl = site.url + \"/_api/search/query?Querytext='\" + \n                                searchTerm + \"'&amp;Properties='GraphQuery:ACTOR(ME\" + \n                                    actions ? (\", \" + actions) : \"\" + \")\";\n\n                Utils.Request.get(searchUrl, cache).then(function(board) {\n                    board = Utils.SPHelper.formatSearchResponse(board);\n                    resolve(board);\n                }, function(err) {\n                     reject(err);\n                });\n            }\n        });\n    };\n\n    return methods;\n};\n\nexport default Delve;\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/sp-delve.js\n **/","import Utils from './utils/utils';\n\nfunction Files(filePath) {\n    var site = this,\n        methods = {};\n\n    methods.generateExternalLink = function(hours) {\n        hours = hours ? hours : 24;\n\n        var listUrl = site.url + \"/_api/Web/GetFileByServerRelativeUrl('\" + filePath + \n                        \"')/GetPreAuthorizedAccessUrl(\" + hours + \")\";\n\n        return Utils.Request.get(listUrl, true);\n    };\n\n    methods.uploadViaModal = function(GUID) {\n        return new Promise(function(resolve, reject) {\n            var dialogOptions = {};\n\n            dialogOptions.url = site.url + \"/_layouts/Upload.aspx?List=\" + GUID + \"&IsDlg=1\";\n\n            dialogOptions.dialogReturnValueCallback = Function.createDelegate(null, function(result, value) {\n                resolve(value);\n            });\n\n            SP.UI.ModalDialog.showModalDialog(dialogOptions);\n        });\n    };\n\n    methods.upload = function(fileInput, expand) {\n        return new Promise(function(resolve, reject) {\n            var reader = new FileReader();\n\n            reader.onloadend = function(e) {\n                var parts = fileInput.value.split('\\\\'),\n                    fileName = parts[parts.length - 1],\n                    url = site.url + \"/_api/Web/GetFolderByServerRelativeUrl('\" + filePath + \n                            \"')/files/add(overwrite=true, url='\" + fileName + \"')\" + \n                                (expand ? \"?$\" + expand : \"\");\n\n                Utils.Request.post(url, e.target.result, true).then(function(result) {\n                    resolve(result);\n                }, function(result) {\n                    reject(result);\n                });\n            };\n\n            reader.onerror = function(e) {\n                reject(e.target.error);\n            };\n\n            reader.readAsArrayBuffer(fileInput.files[0]);\n        });\n    };\n\n    methods.uploadFile = function(file, expand) {\n        return new Promise(function(resolve, reject) {\n            var reader = new FileReader();\n\n            reader.onloadend = function(e) {                \n                var fileName = file ? file.name : \"\",\n                    url = site.url + \"/_api/Web/GetFolderByServerRelativeUrl('\" + filePath + \n                            \"')/files/add(overwrite=true, url='\" + fileName + \"')\" + \n                                (expand ? \"?$\" + expand : \"\");\n\n                Utils.Request.post(url, e.target.result, true).then(function(result) {\n                    resolve(result);\n                }, function(result) {\n                    reject(result);\n                });\n            };\n\n            reader.onerror = function(e) {\n                reject(e.target.error);\n            };\n\n            reader.readAsArrayBuffer(file);\n        });\n    };\n\n    methods.query = function(cache) {\n        var url = site.url + \"/_api/web/getfilebyserverrelativeurl('\" + filePath + \"')/ListItemAllFields\";\n\n        return Utils.Request.get(url, cache);\n    };\n\n    methods.download = function() {\n        window.open('/_layouts/download.aspx?SourceUrl=' + site.url + filePath);\n    };\n\n    methods.openInWebApps = function(newTab) {\n        var url = site.url + filePath;\n\n        if (newTab) {\n            window.open(Utils.SPHelper.convertToWebApp(url));\n        } \n        else {\n            window.location.href = Utils.SPHelper.convertToWebApp(url);\n        }\n    };\n\n    return methods;\n};\n\nexport default Files;\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/sp-files.js\n **/","import Utils from './utils/utils';\n\nfunction Lists(listTitle) {\n    var site = this,\n        methods = {};\n\n    methods.query = function(settings, cache) {\n        var listUrl = site.url + '/_api/web/lists/getByTitle%28%27' + listTitle + '%27%29/';\n\n        listUrl += settings ? '?' + Utils.Conversion.objToQueryString(settings) : '';\n\n        return Utils.Request.get(listUrl, cache);\n    };\n\n    methods.create = function(settings) {\n        var defaults = {\n            __metadata: {\n                'type': 'SP.List'\n            },\n            BaseTemplate: 100,\n            Description: ''\n        };\n\n        if (settings) {\n            defaults = Utils.Objects.merge(defaults, settings);\n        }\n\n        return Utils.Request.post(site.url + '/_api/web/lists', defaults);\n    };\n\n    methods.update = function(data) {\n        var listUrl = site.url + '/_api/web/lists/getByTitle%28%27' + listTitle + '%27%29',\n            defaults = {\n                __metadata: {\n                    'type': Utils.SPHelper.getListItemType(listTitle)\n                }\n            };\n\n        if (data) {\n            defaults = Utils.Objects.merge(defaults, data);\n        }\n\n        return Utils.Request.put(listUrl, defaults);\n    };\n\n    methods.delete = function() {\n        var listUrl = site.url + '/_api/web/lists/getByTitle%28%27' + listTitle + '%27%29',\n            defaults = {\n                __metadata: {\n                    'type': Utils.SPHelper.getListItemType(listTitle)\n                }\n            };\n\n        return Utils.Request.delete(listUrl, defaults);\n    };\n\n    return methods;\n};\n\nexport default Lists;\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/sp-lists.js\n **/","import Utils from './utils/utils';\n\nfunction Search(searchTerm) {\n    var site = this,\n        methods = {};\n\n    methods.query = function(settings, cache) {\n        return new Promise(function(resolve, reject) {\n            var searchUrl = site.url + '/_api/search/query?querytext=%27' + searchTerm + \n                                ' +path:' + site.url + '%27';\n\n            searchUrl += settings ? '?' + Utils.Conversion.objToQueryString(settings) : '';\n\n            Utils.Request.get(searchUrl, cache).then(function(result) {\n                result = Utils.SPHelper.formatSearchResponse(result);\n                resolve(result);\n            }, function(err) {\n                reject(err);\n            });\n        });\n    };\n\n    return methods;\n};\n\nexport default Search;\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/sp-search.js\n **/","import { Utils } from './utils/utils';\n\nfunction Profile() {\n    var user = this,\n        methods = {},\n        loginNamePrefix = 'i:0%23.f|membership|';\n\n    methods.query = function(cache) {\n        var listUrl = window._spPageContextInfo.webAbsoluteUrl;\n\n        if (user.loginName) {\n            listUrl += \"/_api/SP.UserProfiles.PeopleManager/GetPropertiesFor(accountName=@v)?@v=%27\" + \n                            loginNamePrefix + user.loginName + \"%27\";\n        } \n        else {\n            listUrl += \"/_api/SP.UserProfiles.PeopleManager/GetMyProperties/UserProfileProperties\";\n        }\n\n        return Utils.Request.get(listUrl, cache);\n    };\n\n    methods.isMemberOfGroup = function(site, groupName, userId, cache) {\n        var user = userId ? userId : window._spPageContextInfo.userId,\n            listUrl = site.url + \"/_api/web/sitegroups/getByName('\" + groupName + \n                        \"')/Users?$filter=Id eq \" + user;\n\n        return Utils.Request.get(listUrl, cache);\n    };\n\n    return methods;\n};\n\nexport default Profile;\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/sp-users.js\n **/"],"sourceRoot":""}